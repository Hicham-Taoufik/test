<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta
      name="description"
      content="Dashboard de réception pour la gestion des patients - MediClinic"
    />
    <title>Réception - MediClinic</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Select2 CSS -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/css/select2.min.css"
      rel="stylesheet"
    />
<script src="script.js" defer></script>
    <link rel="stylesheet" href="style.css" />

    
  </head>
  <body>
    <a href="#main-content" class="skip-link">Passer au contenu principal</a>
    <div class="container">
      <div class="header">
        <div class="header-main-content">
          <div class="logo">
            <img
              src="./clinique-nakhil-logo-horizontal.webp"
              alt="MediClinic Logo"
              class="logo-img"
            />
          </div>
          <h1 class="header-title">Réception</h1>
        </div>
        <div class="header-logout">
          <button
            onclick="logout()"
            class="btn btn-outline logout-btn no-print"
            aria-label="Déconnexion"
          >
            <i class="fas fa-sign-out-alt" aria-hidden="true"></i> Déconnexion
          </button>
        </div>
      </div>

      <main id="main-content" class="flex-row">
        <div class="flex-col">
          <section class="card" aria-labelledby="create-patient-heading">
            <div class="card-header">
              <h2 id="create-patient-heading" class="card-title">
                <i class="fas fa-user-plus" aria-hidden="true"></i> Créer un
                Patient
              </h2>
              <div class="card-actions" aria-hidden="true">
                <i class="fas fa-pen"></i>
              </div>
            </div>
            <div class="card-body">
              <!-- ID Capture Section -->
              <div class="id-capture-section mb-4 no-print">
                <button
                  id="captureIdButton"
                  type="button"
                  class="btn btn-primary"
                >
                  <i class="fas fa-camera"></i> Scanner CIN
                </button>
                <div id="idCaptureContainer">
                  <p id="captureInstruction">
                    Positionnez le RECTO de la CIN et prenez la photo.
                  </p>
                  <video id="idVideo" playsinline></video>
                  <canvas id="idCanvas" style="display: none"></canvas>
                  <div class="d-flex justify-content-center gap-2 my-2">
                    <img
                      id="frontPreview"
                      class="capture-preview"
                      alt="Aperçu Recto"
                      style="display: none"
                    />
                    <img
                      id="backPreview"
                      class="capture-preview"
                      alt="Aperçu Verso"
                      style="display: none"
                    />
                  </div>
                  <div class="btn-group mt-2">
                    <button
                      id="takePhotoButton"
                      type="button"
                      class="btn btn-success"
                      disabled
                    >
                      <i class="fas fa-camera-retro"></i> Prendre Photo
                    </button>
                    <button
                      id="cancelCaptureButton"
                      type="button"
                      class="btn btn-secondary"
                      disabled
                    >
                      Annuler
                    </button>
                  </div>
                  <div
                    id="captureMessage"
                    class="message message-info mt-2"
                  ></div>
                </div>
              </div>
              <!-- END ID Capture Section -->

              <form id="createForm" novalidate>
                <div class="form-grid">
                  <div class="input-group">
                    <label for="nom"
                      >Nom <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="nom"
                      name="nom"
                      type="text"
                      placeholder="Nom de famille"
                      required
                      aria-required="true"
                      autocomplete="family-name"
                    />
                    <div class="error-text">Veuillez entrer un nom</div>
                  </div>
                  <div class="input-group">
                    <label for="prenom"
                      >Prénom <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="prenom"
                      name="prenom"
                      type="text"
                      placeholder="Prénom"
                      required
                      aria-required="true"
                      autocomplete="given-name"
                    />
                    <div class="error-text">Veuillez entrer un prénom</div>
                  </div>
                  <div class="input-group">
                    <label for="cin"
                      >CIN <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="cin"
                      name="cin"
                      type="text"
                      placeholder="Ex: AB123456"
                      required
                      aria-required="true"
                      pattern="^[A-Za-z]{1,2}\d{5,6}$"
                    />
                    <div class="error-text">
                      Format CIN invalide (ex: AB123456)
                    </div>
                  </div>
                  <div class="input-group">
                    <label for="telephone"
                      >Téléphone <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="telephone"
                      name="telephone"
                      type="tel"
                      placeholder="Ex: 0612345678"
                      required
                      aria-required="true"
                      autocomplete="tel"
                      pattern="^0[5-7]\d{8}$"
                    />
                    <div class="error-text">
                      Format téléphone invalide (0Xxxxxxxxx)
                    </div>
                  </div>
                  <div class="input-group">
                    <label for="adresse"
                      >Adresse <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="adresse"
                      name="adresse"
                      type="text"
                      placeholder="Adresse complète"
                      required
                      aria-required="true"
                      autocomplete="address-line1"
                    />
                    <div class="error-text">Veuillez entrer une adresse</div>
                  </div>
                  <div class="input-group">
                    <label for="ville"
                      >Ville <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="ville"
                      name="ville"
                      type="text"
                      placeholder="Ville"
                      required
                      aria-required="true"
                      autocomplete="address-level2"
                    />
                    <div class="error-text">Veuillez entrer une ville</div>
                  </div>
                  <div class="input-group">
                    <label for="date_naissance"
                      >Date de Naissance
                      <span aria-hidden="true">*</span></label
                    >
                    <input
                      id="date_naissance"
                      name="date_naissance"
                      type="date"
                      required
                      aria-required="true"
                      autocomplete="bday"
                    />
                    <div class="error-text">
                      Veuillez entrer une date valide
                    </div>
                  </div>
                  <div class="input-group">
                    <label for="sexe"
                      >Sexe <span aria-hidden="true">*</span></label
                    >
                    <select
                      id="sexe"
                      name="sexe"
                      required
                      aria-required="true"
                      autocomplete="sex"
                    >
                      <option value="" disabled selected>Choisir...</option> <!-- Added placeholder -->
                      <option value="M">Homme</option>
                      <option value="F">Femme</option>
                    </select>
                    <div class="error-text">Veuillez sélectionner un sexe</div>
                  </div>
                  <!-- Updated Mutuelle Dropdown -->
                  <div class="input-group mutuelle-group">
                    <label for="mutuelle">Mutuelle</label>
                    <select name="mutuelle" id="mutuelle" class="form-select">
                      <option value="" disabled selected>
                        Choisir une mutuelle...
                      </option>
                       <!-- Options populated by JS -->
                    </select>
                    <div class="error-text">
                      Veuillez choisir une mutuelle (si applicable)
                    </div>
                  </div>
                  <!-- New Doctor Dropdown -->
                  <div class="input-group">
                    <label for="doctor">Médecin</label>
                    <select name="doctor" id="doctor" class="form-select">
                      <option value="" disabled selected>
                        Choisir un médecin...
                      </option>
                       <!-- Options populated by JS -->
                    </select>
                    <div class="error-text">Veuillez choisir un médecin</div>
                  </div>
                  <!-- End Doctor Dropdown -->

                  <div class="form-submit-button">
                    <button
                      type="submit"
                      class="btn btn-success"
                      id="createPatientBtn"
                    >
                      <i class="fas fa-plus-circle" aria-hidden="true"></i>
                      Créer Patient & Démarrer Visite <!-- Updated Text -->
                    </button>
                  </div>
                  <div
                    id="message"
                    class="message"
                    role="alert"
                    aria-live="polite"
                  ></div>
                </div>
              </form>
              <div id="createResult">
                <p id="createResultMessage"></p>
                <img id="createQrCodeImage" src="" alt="" loading="lazy" />
                <button
                  id="createPrintButton"
                  class="btn btn-secondary"
                  disabled
                >
                  <i class="fas fa-print" aria-hidden="true"></i> Imprimer QR
                  Code
                </button>
              </div>
            </div>
          </section>
        </div>

        <div class="flex-col">
          <section class="card" aria-labelledby="search-patient-heading">
            <div class="card-header">
              <h2 id="search-patient-heading" class="card-title">
                <i class="fas fa-search" aria-hidden="true"></i> Rechercher un
                Patient
              </h2>
              <div class="card-actions" aria-hidden="true">
                <i class="fas fa-users"></i>
              </div>
            </div>
            <div class="card-body">
              <div class="search-bar">
                <input
                  id="getCin"
                  type="text"
                  placeholder="Entrer le CIN du patient"
                  aria-label="Numéro CIN du patient"
                />
                <button id="searchBtn" class="btn btn-primary">
                  <i class="fas fa-search" aria-hidden="true"></i> Rechercher & Démarrer Visite <!-- Updated Text -->
                </button>
              </div>
              <div id="getResult" role="region" aria-live="polite"></div>
            </div>
          </section>
        </div>
      </main>

      <div id="toast" class="toast" role="alert" aria-live="assertive"></div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Select2 JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/js/select2.min.js"></script>
    <script>

    </script>
  </body>
</html>
